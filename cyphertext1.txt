table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emaitable of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai
table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher mprentice hallpub date november  print isbn print isbn etext isbn etext isbn pages in this age of viruses and hackers of electronic eavesdropping and electronic fraud security is paramount.as the disciplines of cryptography and network security have matured more practical readily availableapplications to enforce network security have developed. this text provides a practical survey of both theprinciples and practice of cryptography and network security. first the basic issues to be addressed by anetwork security capability are explored through a tutorial and survey of cryptography and network securitytechnology. then the practice of network security is explored via practical applications that have beenimplemented and are in use today. table of contents indexcryptography and network security principles and practices fourth editionby william stallingspublisher prentice hallpub date november  print isbn print isbn etext isbn etext isbn pages copyrightnotation xipreface xiiiobjectives xiiiintended audience xiiiplan of the book xivinternet services for instructors and students xivprojects for teaching cryptography and network security xivwhats new in the fourth edition xvacknowledgments xvichapter . readers guide section . outline of this book section . roadmap section . internet and web resources chapter . introduction section . security trends section . the osi security architecture section . security attacks section . security services section . security mechanisms section . a model for network security section . recommended reading and web sites section . key terms review questions and problems part one symmetric ciphers chapter . classical encryption techniques section . symmetric cipher model section . substitution techniques section . transposition techniques section . rotor machines section . steganography section . recommended reading and web sites section . key terms review questions and problems chapter . block ciphers and the data encryption standard section . block cipher principles section . the data encryption standard section . the strength of des section . differential and linear cryptanalysis section . block cipher design principles section . recommended reading section . key terms review questions and problems chapter . finite fields section . groups rings and fields section . modular arithmetic section . the euclidean algorithm section . finite fields of the form gfp section . polynomial arithmetic section . finite fields of the form gfn section . recommended reading and web sites section . key terms review questions and problems chapter . advanced encryption standard section . evaluation criteria for aes section . the aes cipher section . recommended reading and web sites section . key terms review questions and problems appendix a polynomials with coefficients in gf appendix b simplified aes chapter . more on symmetric ciphers section . multiple encryption and triple des section . block cipher modes of operation section . stream ciphers and rc section . recommended reading and web site section . key terms review questions and problems chapter . confidentiality using symmetric encryption section . placement of encryption function section . traffic confidentiality section . key distribution section . random number generation section . recommended reading and web sites section . key terms review questions and problems part two publickey encryption and hash functions chapter . introduction to number theory section . prime numbers section . fermats and eulers theorems section . testing for primality section . the chinese remainder theorem section . discrete logarithms section . recommended reading and web sites section . key terms review questions and problems chapter . publickey cryptography and rsa section . principles of publickey cryptosystems section . the rsa algorithm section . recommended reading and web sites section . key terms review questions and problems appendix a proof of the rsa algorithm appendix b the complexity of algorithms chapter . key management other publickey cryptosystems section . key management section . diffiehellman key exchange section . elliptic curve arithmetic section . elliptic curve cryptography section . recommended reading and web sites section . key terms review questions and problems chapter . message authentication and hash functions section . authentication requirements section . authentication functions section . message authentication codes section . hash functions section . security of hash functions and macs section . recommended reading section . key terms review questions and problems appendix a mathematical basis of the birthday attack chapter . hash and mac algorithms section . secure hash algorithm section . whirlpool section . hmac section . cmac section . recommended reading and web sites section . key terms review questions and problems chapter . digital signatures and authentication protocols section . digital signatures section . authentication protocols section . digital signature standard section . recommended reading and web sites section . key terms review questions and problems part three network security applications chapter . authentication applications section . kerberos section . x. authentication service section . publickey infrastructure section . recommended reading and web sites section . key terms review questions and problems appendix a kerberos encryption techniques chapter . electronic mail security section . pretty good privacy section . smime section . key terms review questions and problems appendix a data compression using zip appendix b radix conversion appendix c pgp random number generation chapter . ip security section . ip security overview section . ip security architecture section . authentication header section . encapsulating security payload section . combining security associations section . key management section . recommended reading and web site section . key terms review questions and problems appendix a internetworking and internet protocols chapter . web security section . web security considerations section . secure socket layer and transport layer security section . secure electronic transaction section . recommended reading and web sites section . key terms review questions and problems part four system security chapter . intruders section . intruders section . intrusion detection section . password management section . recommended reading and web sites section . key terms review questions and problems appendix a the baserate fallacy chapter . malicious software section . viruses and related threats section . virus countermeasures section . distributed denial of service attacks section . recommended reading and web sites section . key terms review questions and problems chapter . firewalls section . firewall design principles section . trusted systems section . common criteria for information technology security evaluation section . recommended reading and web sites section . key terms review questions and problems appendix a. standards and standardssetting organizations section a. the importance of standards section a. internet standards and the internet society section a. national institute of standards and technology appendix b. projects for teaching cryptography and network security section b. research projects section b. programming projects section b. laboratory exercises section b. writing assignments section b. readingreport assignments glossary references abbreviations inside front cover insidefrontcoverinside back cover insidebackcoverindexcopyrightpage iilibrary of congress cataloginginpublication data on filevice president and editorial director ecs marcia j. hortonexecutive editor tracy dunkelbergereditorial assistant christianna leeexecutive managing editor vince obrienmanaging editor camille trentacosteproduction editor rose kernandirector of creative services paul belfanticover designer bruce kenselaarmanaging editor av management and production patricia burnsart editor gregory dullesmanufacturing manager alexis heydtlongmanufacturing buyer lisa mcdowellmarketing manager robin obrienmarketing assistant barrie reinhold  pearson education inc.pearson prentice hallpearson education inc.upper saddle river nj all rights reserved. no part of this book may be reproduced in any form or by any means without permission in writing from thepublisher.pearson prentice hall is a trademark of pearson education inc.the author and publisher of this book have used their best efforts in preparing this book. these efforts include the developmentresearch and testing of the theories and programs to determine their effectiveness. the author and publisher make no warranty of anykind expressed or implied with regard to these programs or the documentation contained in this book. the author and publisher shallnot be liable in any event for incidental or consequential damages in connection with or arising out of the furnishing performance oruse of these programs.printed in the united states of america         pearson education ltd. londonpearson education australia pty. ltd. sydneypearson education singapore pte. ltd.pearson education north asia ltd. hong kongpearson education canada inc. torontopearson educacon de mexico s.a. de c.v.pearson educationjapan tokyopearson education malaysia pte. ltd.pearson education inc. upper saddle river new jerseypage iiidedicationto antigone never dull never boring always a sagepage xinotationeven the natives have difficulty mastering this peculiar vocabulary.the golden bough sir james george frazersymbol expression meaningd k dk y symmetric decryption of ciphertext y using secret key k.d pra dpra y asymmetric decryption of ciphertext y using as private key pradpua dpua y asymmetric decryption of ciphertext y using as public key puae k ek x symmetric encryption of plaintext x using secret key k.e pra epra x asymmetric encryption of plaintext x using as private key prae pua epua x asymmetric encryption of plaintext x using as public key puak secret keypra private key of user apua public key of user ac k ck x message authentication code of message x using secret key k.gfp the finite field of order p where p is prime. the field is defined as theset zp together with the arithmetic operations modulo p.gfn the finite field of order n.zn set of nonnegative integers less than ngcd gcdi j greatest common divisor the largest positive integer that divides both iand j with no remainder on division.mod a mod m remainder after division of a by m.mod a bmod m a mod m  b mod mmod a bmod m a mod m b mod mdlog dlogapb discrete logarithm of the number b for the base a mod pf fn the number of positive integers less than n and relatively prime to n.this is eulers totient function.s a  a  .  ansymbol expression meaninga x a x . x an ij i divides j which means that there is no remainder when j is divided by i a absolute value of a xy x concatenated with yx yx is approximately equal to yx yexclusiveor of x and y for singlebit variables bitwise exclusiveorof x and y for multiplebit variables xthe largest integer less than or equal to xx s the element x is contained in the set s.a aa .ak the integer a corresponds to the sequence of integers aa .akpage xiiiprefacethe tie if i might suggest it sir a shade more tightly knotted. one aims at the perfect butterfly effect. if you willpermit mewhat does it matter jeeves at a time like this do you realize that mr. littles domestic happiness is hanging inthe scalethere is no time sir at which ties do not matter.very good jeeves p. g. wodehousein this age of universal electronic connectivity of viruses and hackers of electronic eavesdropping and electronic fraud there is indeedno time at which security does not matter. two trends have come together to make the topic of this book of vital interest. first theexplosive growth in computer systems and their interconnections via networks has increased the dependence of both organizations andindividuals on the information stored and communicated using these systems. this in turn has led to a heightened awareness of theneed to protect data and resources from disclosure to guarantee the authenticity of data and messages and to protect systems fromnetworkbased attacks. second the disciplines of cryptography and network security have matured leading to the development ofpractical readily available applications to enforce network security.page xiii continuedobjectivesit is the purpose of this book to provide a practical survey of both the principles and practice of cryptography and network security. in thefirst two parts of the book the basic issues to be addressed by a network security capability are explored by providing a tutorial andsurvey of cryptography and network security technology. the latter part of the book deals with the practice of network security practicalapplications that have been implemented and are in use to provide network security.the subject and therefore this book draws on a variety of disciplines. in particular it is impossible to appreciate the significance ofsome of the techniques discussed in this book without a basic understanding of number theory and some results from probability theory.nevertheless an attempt has been made to make the book selfcontained. the book presents not only the basic mathematical resultsthat are needed but provides the reader with an intuitive understanding of those results. such background material is introduced asneeded. this approach helps to motivate the material that is introduced and the author considers this preferable to simply presenting allof the mathematical material in a lump at the beginning of the book.page xiii continuedintended audiencethe book is intended for both an academic and a professional audience. as a textbook it is intended as a onesemester undergraduatecourse in cryptography and network security for computer science computer engineering and electrical engineering majors. it covers thematerial in ias security mechanisms a core area in the information technology body of knowledge net security another core areain the information technology body of knowledge and it cryptography an advanced course these subject areas are part of thedraft acmieee computer society computing curricula .page xivthe book also serves as a basic reference volume and is suitable for selfstudy.page xiv continuedplan of the bookthe book is organized in four partspart one. conventional encryption a detailed examination of conventional encryption algorithms and designprinciples including a discussion of the use of conventional encryption for confidentiality.part two. publickey encryption and hash functions a detailed examination of publickey encryptionalgorithms and design principles. this part also examines the use of message authentication codes and hashfunctions as well as digital signatures and publickey certificates.part three. network security practice covers important network security tools and applications includingkerberos x.v certificates pgp smime ip security ssltls and set.part four. system security looks at systemlevel security issues including the threat of and countermeasuresfor intruders and viruses and the use of firewalls and trusted systems.in addition the book includes an extensive glossary a list of frequently used acronyms and a bibliography. each chapter includeshomework problems review questions a list of key words suggestions for further reading and recommended web sites.a more detailed chapterbychapter summary of each part appears at the beginning of that part.page xiv continuedinternet services for instructors and studentsthere is a web site for this book that provides support for students and instructors. the site includes links to other relevant sitestransparency masters of figures and tables in the book in pdf adobe acrobat format and powerpoint slides. the web page is atwilliamstallings.comcryptocryptoe.html. as soon as typos or other errors are discovered an errata list for this book will be availableat williamstallings.com. in addition the computer science student resource site at williamstallings.comstudentsupport.htmlprovides documents information and useful links for computer science students and professionals.page xiv continuedprojects for teaching cryptography and network securityfor many instructors an important component of a cryptography or security course is a project or set of projects by which the studentgets handson experience to reinforce concepts from the text. this book provides an unparalleled degree of support for including aprojects component in the course. the instructors manual not only includes guidance on how to assign and structure the projects butalso includes a set of suggested projects that covers a broad range of topics from the textpage xvresearch projects a series of research assignments that instruct the student to research a particular topic on the internetand write a reportprogramming projects a series of programming projects that cover a broad range of topics and that can be implemented inany suitable language on any platformlab exercises a series of projects that involve programming and experimenting with concepts from the bookwriting assignments a set of suggested writing assignments by chapterreadingreport assignments a list of papers in the literature one for each chapter that can be assigned for the student toread and then write a short reportsee appendix b for details.page xv continuedwhats new in the fourth editionin the three years since the third edition of this book was published the field has seen continued innovations and improvements. in thisnew edition i try to capture these changes while maintaining a broad and comprehensive coverage of the entire field. to begin thisprocess of revision the third edition was extensively reviewed by a number of professors who teach the subject. in addition a number ofprofessionals working in the field reviewed individual chapters. the result is that in many places the narrative has been clarified andtightened and illustrations have been improved. also a large number of new fieldtested problems have been added.beyond these refinements to improve pedagogy and user friendliness there have been major substantive changes throughout the book.highlights include the followingsimplified aes this is an educational simplified version of aes advanced encryption standard which enables studentsto grasp the essentials of aes more easily.whirlpool this is an important new secure hash algorithm based on the use of a symmetric block cipher.cmac this is a new block cipher mode of operation. cmac cipherbased message authentication code provides messageauthentication based on the use of a symmetric block cipher.publickey infrastructure pki this important topic is treated in this new edition.distributed denial of service ddos attacks ddos attacks have assumed increasing significance in recent years.common criteria for information technology security evaluation the common criteria have become the internationalframework for expressing security requirements and evaluating products and implementations.online appendices six appendices available at this books web site supplement the material in the text.in addition much of the other material in the book has been updated and revised.page xviacknowledgmentsthis new edition has benefited from review by a number of people who gave generously of their time and expertise. the followingpeople reviewed all or a large part of the manuscript danny krizanc wesleyan university breno de medeiros florida stateuniversity roger h. brown rensselaer at hartford cristina nitarotarul purdue university and jimmy mcgibney waterfordinstitute of technology.thanks also to the many people who provided detailed technical reviews of a single chapter richard outerbridge jorge nakaharajeroen van de graaf philip moseley andre correa brian bowling james muir andrew holt dcio luiz gazzoni filho lucas ferreiradr. kemal bicakci routo terada anton stiglic valery pryamikov and yongge wang.joan daemen kindly reviewed the chapter on aes. vincent rijmen reviewed the material on whirlpool. and edward f. schaeferreviewed the material on simplified aes.the following people contributed homework problems for the new edition joshua brandon holden rosehulman institute iftechnology kris gaj george mason university and james muir university of waterloo.sanjay rao and ruben torres of purdue developed the laboratory exercises that appear in the instructors supplement. the followingpeople contributed project assignments that appear in the instructors supplement henning schulzrinne columbia university cetinkaya koc oregon state university and david balenson trusted information systems and george washington university.finally i would like to thank the many people responsible for the publication of the book all of whom did their usual excellent job. thisincludes the staff at prentice hall particularly production manager rose kernan my supplements manager sarah parker and my neweditor tracy dunkelberger. also patricia m. daly did the copy editing.with all this assistance little remains for which i can take full credit. however i am proud to say that with no help whatsoever i selectedall of the quotations.page chapter . readers guide. outline of this book. roadmapsubject mattertopic ordering. internet and web resourcesweb sites for this bookother web sitesusenet newsgroupspage the art of war teaches us to rely not on the likelihood of the enemys not coming but on our own readiness toreceive him not on the chance of his not attacking but rather on the fact that we have made our positionunassailable.the art of war sun tzuthis book with its accompanying web site covers a lot of material. here we give the reader an overview.page  continued. outline of this bookfollowing an introductory chapter chapter  the book is organized into four partspart one symmetric ciphers provides a survey of symmetric encryption including classical and modernalgorithms. the emphasis is on the two most important algorithms the data encryption standard des and theadvanced encryption standard aes. this part also addresses message authentication and key management.part two publickey encryption and hash functions provides a survey of publickey algorithms includingrsa rivestshamiradelman and elliptic curve. it also covers publickey applications including digital signaturesand key exchange.part three network security practice examines the use of cryptographic algorithms and security protocols toprovide security over networks and the internet. topics covered include user authentication email ip securityand web security.part four system security deals with security facilities designed to protect a computer system from securitythreats including intruders viruses and worms. this part also looks at firewall technology.many of the cryptographic algorithms and network security protocols and applications described in this book have been specified asstandards. the most important of these are internet standards defined in internet rfcs request for comments and federalinformation processing standards fips issued by the national institute of standards and technology nist. appendix a discussesthe standardsmaking process and lists the standards cited in this book.page  continued. roadmapsubject matterthe material in this book is organized into three broad categoriescryptology this is the study of techniques for ensuring the secrecy andor authenticity of information. the twomain branches of cryptology are cryptography which is the study of the design of such techniques andcryptanalysis which deals with the defeating such techniques to recover information or forging information thatwill be accepted as authentic.page network security this area covers the use of cryptographic algorithms in network protocols and networkapplications.computer security in this book we use this term to refer to the security of computers against intruders e.g.hackers and malicious software e.g. viruses. typically the computer to be secured is attached to a network andthe bulk of the threats arise from the network.the first two parts of the book deal with two distinct cryptographic approaches symmetric cryptographic algorithms and publickey orasymmetric cryptographic algorithms. symmetric algorithms make use of a single shared key shared by two parties. publickeyalgorithms make use of two keys a private key known only to one party and a public key available to other parties.topic orderingthis book covers a lot of material. for the instructor or reader who wishes a shorter treatment there are a number of opportunities.to thoroughly cover the material in the first two parts the chapters should be read in sequence. with the exception of the advancedencryption standard aes none of the material in part one requires any special mathematical background. to understand aes it isnecessary to have some understanding of finite fields. in turn an understanding of finite fields requires a basic background in primenumbers and modular arithmetic. accordingly chapter  covers all of these mathematical preliminaries just prior to their use inc hapter on aes. thus if chapter  is skipped it is safe to skip chapter  as well.chapter  introduces some concepts that are useful in later chapters ofp art one. however for the reader whose sole interest iscontemporary cryptography this chapter can be quickly skimmed. the two most important symmetric cryptographic algorithms are desand aes which are covered in chapters  and  respectively. chapter  covers two other interesting algorithms both of which enjoycommercial use. this chapter can be safely skipped if these algorithms are not of interest.for part two the only additional mathematical background that is needed is in the area of number theory which is covered inc hapter .the reader who has skipped chapters  and  should first review the material on sections . through .the two most widely used generalpurpose publickey algorithms are rsa and elliptic curve with rsa enjoying much wider acceptance.the reader may wish to skip the material on elliptic curve cryptography in chapter  at least on a first reading. in chapter  whirlpooland cmac are of lesser importance.part three and part four are relatively independent of each other and can be read in either order. both parts assume a basicunderstanding of the material in parts one and two.page . internet and web resourcesthere are a number of resources available on the internet and the web to support this book and to help one keep up withdevelopments in this field.web sites for this booka special web page has been set up for this book at williamstallings.comcryptocryptoe.html. the site includes the followinguseful web sites there are links to other relevant web sites organized by chapter including the sites listed in this sectionand throughout this book.errata sheet an errata list for this book will be maintained and updated as needed. please emai